!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("preact")):"function"==typeof define&&define.amd?define(["preact"],t):e.Downshift=t(e.preact)}(this,function(e){"use strict";var t="default"in e?e.default:e,n="undefined"==typeof document?null:document.getElementById("a11y-status-message"),o=[];function i(e){var t=o[o.length-1]===e;o=t?[].concat(o,[e]):[e];for(var i=function(){if(n)return n;return(n=document.createElement("div")).setAttribute("id","a11y-status-message"),n.setAttribute("role","status"),n.setAttribute("aria-live","assertive"),n.setAttribute("aria-relevant","additions text"),Object.assign(n.style,{border:"0",clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0",position:"absolute",width:"1px"}),document.body.appendChild(n),n}();i.lastChild;)i.removeChild(i.firstChild);o.filter(Boolean).forEach(function(e,t){i.appendChild(function(e,t){var n=t===o.length-1?"block":"none",i=document.createElement("div");return i.style.display=n,i.textContent=e,i}(e,t))})}var r=0;function s(e){return"function"==typeof e?e:u}function u(){}var l=function e(t,n,o){return null!==n&&n!==o.parentNode?t(n)?n===document.body&&0===n.scrollTop?document.documentElement:n:e(t,n.parentNode,o):null}.bind(null,function(e){return e.scrollHeight>e.clientHeight});function p(e,t){return e===t||e.contains(t)}function a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return t.some(function(t){return t&&t.apply(void 0,[e].concat(o)),e.preventDownshiftDefault||e.defaultPrevented})}}function d(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.find(function(e){return void 0!==e})}function h(e,t){return!(e=Array.isArray(e)?e[0]:e)&&t?t:e}function c(e){return e.nodeName?"string"==typeof e.nodeName:"string"==typeof e.type}function g(e){return e.props||e.attributes}var f=["highlightedIndex","inputValue","isOpen","selectedItem","type"];function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return f.forEach(function(n){e.hasOwnProperty(n)&&(t[n]=e[n])}),t}function y(e){var t=e.key,n=e.keyCode;return n>=37&&n<=40&&0!==t.indexOf("Arrow")?"Arrow"+t:t}var v=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},_=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},w=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},S=function(e){function n(){v(this,n);for(var t=arguments.length,o=Array(t),i=0;i<t;i++)o[i]=arguments[i];var s=w(this,e.call.apply(e,[this].concat(o)));C.call(s);var u=s.getState({highlightedIndex:s.props.defaultHighlightedIndex,isOpen:s.props.defaultIsOpen,inputValue:s.props.defaultInputValue,selectedItem:s.props.defaultSelectedItem});return u.selectedItem&&(u.inputValue=s.props.itemToString(u.selectedItem)),s.state=u,s.id=s.props.id||"downshift-"+String(r++),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,e),n.prototype.getState=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state;return Object.keys(t).reduce(function(n,o){return n[o]=e.isControlledProp(o)?e.props[o]:t[o],n},{})},n.prototype.isControlledProp=function(e){return void 0!==this.props[e]},n.prototype.getItemCount=function(){return null!=this.itemCount?this.itemCount:void 0!==this.props.itemCount?this.props.itemCount:this.items.length},n.prototype.getItemNodeFromIndex=function(e){return this.props.environment.document.getElementById(this.getItemId(e))},n.prototype.scrollHighlightedItemIntoView=function(){!function(e,t){var n=l(e,t);if(null!==n){var o=getComputedStyle(n),i=n.getBoundingClientRect(),r=parseInt(o.borderTopWidth,10),s=r+parseInt(o.borderBottomWidth,10),u=i.top+r,p=e.getBoundingClientRect();if(p.top<0&&i.top<0)n.scrollTop+=p.top;else if(p.top<0)n.scrollTop+=p.top-u;else if(p.top>0&&i.top<0)i.bottom>0&&p.bottom+s>i.bottom&&(n.scrollTop+=p.bottom-i.bottom+s);else{var a=p.top+n.scrollTop-u;a<n.scrollTop?n.scrollTop=a:a+p.height+s>n.scrollTop+i.height&&(n.scrollTop=a+p.height-i.height+s)}}}(this.getItemNodeFromIndex(this.getState().highlightedIndex),this._rootNode)},n.prototype.moveHighlightedIndex=function(e,t){this.getState().isOpen?this.changeHighlightedIndex(e,t):this.setHighlightedIndex(void 0,I({isOpen:!0},t))},n.prototype.changeHighlightedIndex=function(e,t){var n=this.getItemCount()-1;if(!(n<0)){var o=this.getState().highlightedIndex;null===o&&(o=e>0?-1:n+1);var i=o+e;i<0?i=n:i>n&&(i=0),this.setHighlightedIndex(i,t)}},n.prototype.getStateAndHelpers=function(){var e=this.getState(),t=e.highlightedIndex,n=e.inputValue,o=e.selectedItem,i=e.isOpen,r=this.props.itemToString,s=this.id,u=this.getRootProps,l=this.getButtonProps,p=this.getToggleButtonProps,a=this.getLabelProps,d=this.getInputProps,h=this.getItemProps,c=this.openMenu,g=this.closeMenu,f=this.toggleMenu,m=this.selectItem,y=this.selectItemAtIndex,v=this.selectHighlightedItem,I=this.setHighlightedIndex,_=this.clearSelection,w=this.clearItems;return{getRootProps:u,getButtonProps:l,getToggleButtonProps:p,getLabelProps:a,getInputProps:d,getItemProps:h,reset:this.reset,openMenu:c,closeMenu:g,toggleMenu:f,selectItem:m,selectItemAtIndex:y,selectHighlightedItem:v,setHighlightedIndex:I,clearSelection:_,clearItems:w,setItemCount:this.setItemCount,unsetItemCount:this.unsetItemCount,setState:this.internalSetState,itemToString:r,id:s,highlightedIndex:t,inputValue:n,isOpen:i,selectedItem:o}},n.prototype.getItemId=function(e){return this.id+"-item-"+e},n.prototype.componentDidMount=function(){var e=this;this._isMounted=!0;var t=function(){e.isMouseDown=!0},o=function(t){var o=e.props.environment.document;e.isMouseDown=!1;var i=e._rootNode&&p(e._rootNode,t.target),r=e._rootNode&&p(e._rootNode,o.activeElement);i||r||!e.getState().isOpen||e.reset({type:n.stateChangeTypes.mouseUp},function(){return e.props.onOuterClick(e.getStateAndHelpers())})};this.props.environment.addEventListener("mousedown",t),this.props.environment.addEventListener("mouseup",o),this.cleanup=function(){e._isMounted=!1,e.props.environment.removeEventListener("mousedown",t),e.props.environment.removeEventListener("mouseup",o)}},n.prototype.componentDidUpdate=function(e,t){this.isControlledProp("selectedItem")&&this.props.selectedItemChanged(e.selectedItem,this.props.selectedItem)&&this.internalSetState({type:n.stateChangeTypes.controlledPropUpdatedSelectedItem,inputValue:this.props.itemToString(this.props.selectedItem)});var o=void 0===this.props.highlightedIndex?this.state:this.props,i=void 0===e.highlightedIndex?t:e;o.highlightedIndex===i.highlightedIndex||this.avoidScrolling||this.scrollHighlightedItemIntoView(),this.updateStatus()},n.prototype.componentWillUnmount=function(){this.cleanup()},n.prototype.render=function(){var e=h(this.props.render||this.props.children,u);this.clearItems(),this.getRootProps.called=!1,this.getRootProps.refKey=void 0,this.getRootProps.suppressRefError=void 0,this.getLabelProps.called=!1,this.getInputProps.called=!1;var n=h(e(this.getStateAndHelpers()));if(!n)return null;if(this.getRootProps.called)return this.getRootProps.suppressRefError||function(e,t){var n=t.refKey,o="ref"!==n,i=!c(e);if(i&&!o)throw new Error("downshift: You returned a non-DOM element. You must specify a refKey in getRootProps");if(!i&&o)throw new Error('downshift: You returned a DOM element. You should not specify a refKey in getRootProps. You specified "'+n+'"');if(!g(e)[n])throw new Error('downshift: You must apply the ref prop "'+n+'" from getRootProps onto your root element.')}(n,this.getRootProps),n;if(c(n))return t.cloneElement(n,this.getRootProps(g(n)));throw new Error("downshift: If you return a non-DOM element, you must use apply the getRootProps function")},n}(e.Component);S.defaultProps={defaultHighlightedIndex:null,defaultSelectedItem:null,defaultInputValue:"",defaultIsOpen:!1,getA11yStatusMessage:function(e){var t=e.isOpen,n=e.highlightedItem,o=e.selectedItem,i=e.resultCount,r=e.previousResultCount,s=e.itemToString;return t?i?n&&i===r?s(n):i+" "+(1===i?"result is":"results are")+" available, use up and down arrow keys to navigate.":"No results.":o?s(o):""},itemToString:function(e){return null==e?"":String(e)},onStateChange:function(){},onInputValueChange:function(){},onUserAction:function(){},onChange:function(){},onSelect:function(){},onOuterClick:function(){},selectedItemChanged:function(e,t){return e!==t},environment:"undefined"==typeof window?{}:window,stateReducer:function(e,t){return t},breakingChanges:{}},S.stateChangeTypes={unknown:"__autocomplete_unknown__",mouseUp:"__autocomplete_mouseup__",itemMouseEnter:"__autocomplete_item_mouseenter__",keyDownArrowUp:"__autocomplete_keydown_arrow_up__",keyDownArrowDown:"__autocomplete_keydown_arrow_down__",keyDownEscape:"__autocomplete_keydown_escape__",keyDownEnter:"__autocomplete_keydown_enter__",clickItem:"__autocomplete_click_item__",blurInput:"__autocomplete_blur_input__",changeInput:"__autocomplete_change_input__",keyDownSpaceButton:"__autocomplete_keydown_space_button__",clickButton:"__autocomplete_click_button__",blurButton:"__autocomplete_blur_button__",controlledPropUpdatedSelectedItem:"__autocomplete_controlled_prop_updated_selected_item__"};var C=function(){var e,t,n,o=this;this.input=null,this.items=[],this.itemCount=null,this.previousResultCount=0,this.setItemCount=function(e){return o.itemCount=e},this.unsetItemCount=function(){return o.itemCount=null},this.setHighlightedIndex=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.props.defaultHighlightedIndex,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=m(t),o.internalSetState(I({highlightedIndex:e},t))},this.clearSelection=function(e){o.internalSetState({selectedItem:null,inputValue:"",isOpen:!1},e)},this.selectItem=function(e,t,n){t=m(t),o.internalSetState(I({isOpen:!1,highlightedIndex:o.props.defaultHighlightedIndex,selectedItem:e,inputValue:o.isControlledProp("selectedItem")&&o.props.breakingChanges.resetInputOnSelection?o.props.defaultInputValue:o.props.itemToString(e)},t),n)},this.selectItemAtIndex=function(e,t,n){var i=o.items[e];null!=i&&o.selectItem(i,t,n)},this.selectHighlightedItem=function(e,t){return o.selectItemAtIndex(o.getState().highlightedIndex,e,t)},this.internalSetState=function(e,t){var n=void 0,i=void 0,r={},u="function"==typeof e;return!u&&e.hasOwnProperty("inputValue")&&o.props.onInputValueChange(e.inputValue,I({},o.getStateAndHelpers(),e)),o.setState(function(t){t=o.getState(t),e=u?e(t):e,e=o.props.stateReducer(t,e);var s={},l={};return(n=e.hasOwnProperty("selectedItem"))&&e.selectedItem!==t.selectedItem&&(i=e.selectedItem),e.type=e.type||S.stateChangeTypes.unknown,Object.keys(e).forEach(function(n){t[n]!==e[n]&&(r[n]=e[n]),"type"!==n&&(l[n]=e[n],o.isControlledProp(n)||(s[n]=e[n]))}),u&&e.hasOwnProperty("inputValue")&&o.props.onInputValueChange(e.inputValue,I({},o.getStateAndHelpers(),e)),s},function(){s(t)(),Object.keys(r).length>1&&o.props.onStateChange(r,o.getStateAndHelpers()),n&&o.props.onSelect(e.selectedItem,o.getStateAndHelpers()),void 0!==i&&o.props.onChange(i,o.getStateAndHelpers()),o.props.onUserAction(r,o.getStateAndHelpers())})},this.rootRef=function(e){return o._rootNode=e},this.getRootProps=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).suppressRefError,i=void 0!==n&&n,r=t.refKey,s=void 0===r?"ref":r,u=_(t,["refKey"]);return o.getRootProps.called=!0,o.getRootProps.refKey=s,o.getRootProps.suppressRefError=i,I(((e={})[s]=o.rootRef,e),u)},this.keyDownHandlers={ArrowDown:function(e){e.preventDefault();var t=e.shiftKey?5:1;this.moveHighlightedIndex(t,{type:S.stateChangeTypes.keyDownArrowDown})},ArrowUp:function(e){e.preventDefault();var t=e.shiftKey?-5:-1;this.moveHighlightedIndex(t,{type:S.stateChangeTypes.keyDownArrowUp})},Enter:function(e){this.getState().isOpen&&(e.preventDefault(),this.selectHighlightedItem({type:S.stateChangeTypes.keyDownEnter}))},Escape:function(e){e.preventDefault(),this.reset({type:S.stateChangeTypes.keyDownEscape})}},this.buttonKeyDownHandlers=I({},this.keyDownHandlers,{" ":function(e){e.preventDefault(),this.toggleMenu({type:S.stateChangeTypes.keyDownSpaceButton})}}),this.getToggleButtonProps=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onClick,n=e.onKeyDown,i=e.onBlur,r=_(e,["onClick","onKeyDown","onBlur"]),s=o.getState().isOpen,u={onClick:a(t,o.button_handleClick),onKeyDown:a(n,o.button_handleKeyDown),onBlur:a(i,o.button_handleBlur)},l=r.disabled?{}:u;return I({type:"button",role:"button","aria-label":s?"close menu":"open menu","aria-expanded":s,"aria-haspopup":!0,"data-toggle":!0},l,r)},this.getButtonProps=this.getToggleButtonProps,this.button_handleKeyDown=function(e){var t=y(e);o.buttonKeyDownHandlers[t]&&o.buttonKeyDownHandlers[t].call(o,e)},this.button_handleClick=function(e){e.preventDefault(),o.props.environment.document.activeElement===o.props.environment.document.body&&e.target.focus(),o.toggleMenu({type:S.stateChangeTypes.clickButton})},this.button_handleBlur=function(){setTimeout(function(){o.isMouseDown||null!=o.props.environment.document.activeElement&&o.props.environment.document.activeElement.id===o.inputId||o.reset({type:S.stateChangeTypes.blurButton})})},this.getLabelProps=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(o.getLabelProps.called=!0,o.getInputProps.called&&e.htmlFor&&e.htmlFor!==o.inputId)throw new Error('downshift: You provided the htmlFor of "'+e.htmlFor+'" for your label, but the id of your input is "'+o.inputId+'". You must either remove the id from your input or set the htmlFor of the label equal to the input id.');return o.inputId=d(o.inputId,e.htmlFor,o.id+"-input"),I({},e,{htmlFor:o.inputId})},this.getInputProps=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.onKeyDown,i=t.onBlur,r=t.onChange,s=t.onInput,u=_(t,["onKeyDown","onBlur","onChange","onInput"]);if(o.getInputProps.called=!0,o.getLabelProps.called&&u.id&&u.id!==o.inputId)throw new Error('downshift: You provided the id of "'+u.id+'" for your input, but the htmlFor of your label is "'+o.inputId+'". You must either remove the id from your input or set the htmlFor of the label equal to the input id.');o.inputId=d(o.inputId,u.id,o.id+"-input");var l=o.getState(),p=l.inputValue,h=l.isOpen,c=l.highlightedIndex,g=u.disabled?{}:((e={}).onInput=a(r,s,o.input_handleChange),e.onKeyDown=a(n,o.input_handleKeyDown),e.onBlur=a(i,o.input_handleBlur),e);return I({role:"combobox","aria-autocomplete":"list","aria-expanded":h,"aria-activedescendant":h&&"number"==typeof c&&c>=0?o.getItemId(c):null,autoComplete:"off",value:p},g,u,{id:o.inputId})},this.input_handleKeyDown=function(e){var t=y(e);t&&o.keyDownHandlers[t]&&o.keyDownHandlers[t].call(o,e)},this.input_handleChange=function(e){o.internalSetState({type:S.stateChangeTypes.changeInput,isOpen:!0,inputValue:e.target.value})},this.input_handleBlur=function(){setTimeout(function(){var e=o.props.environment.document.activeElement.dataset.toggle&&o._rootNode&&o._rootNode.contains(o.props.environment.document.activeElement);o.isMouseDown||e||o.reset({type:S.stateChangeTypes.blurInput})})},this.getItemProps=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.onMouseMove,i=t.onMouseDown,r=t.onClick,s=t.index,u=t.item,l=void 0===u?function(e,t){throw new Error('The property "'+t+'" is required in "'+e+'"')}("getItemProps","item"):u,p=_(t,["onMouseMove","onMouseDown","onClick","index","item"]);void 0===s?(o.items.push(l),s=o.items.indexOf(l)):o.items[s]=l;var d=((e={onMouseMove:a(n,function(){s!==o.getState().highlightedIndex&&(o.setHighlightedIndex(s,{type:S.stateChangeTypes.itemMouseEnter}),o.avoidScrolling=!0,setTimeout(function(){return o.avoidScrolling=!1},250))}),onMouseDown:a(i,function(e){e.preventDefault()})}).onClick=a(r,function(){o.selectItemAtIndex(s,{type:S.stateChangeTypes.clickItem})}),e),h=p.disabled?{}:d;return I({id:o.getItemId(s)},h,p)},this.clearItems=function(){o.items=[]},this.reset=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];e=m(e),o.internalSetState(function(t){var n=t.selectedItem;return I({isOpen:!1,highlightedIndex:o.props.defaultHighlightedIndex,inputValue:o.props.itemToString(n)},e)},s(t))},this.toggleMenu=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];e=m(e),o.internalSetState(function(t){var n=t.isOpen;return I({isOpen:!n},e)},function(){o.getState().isOpen&&o.setHighlightedIndex(void 0,e),s(t)()})},this.openMenu=function(e){o.internalSetState({isOpen:!0},s(e))},this.closeMenu=function(e){o.internalSetState({isOpen:!1},s(e))},this.updateStatus=(e=function(){if(o._isMounted){var e=o.getState(),t=o.items[e.highlightedIndex],n=o.getItemCount(),r=o.props.getA11yStatusMessage(I({itemToString:o.props.itemToString,previousResultCount:o.previousResultCount,resultCount:n,highlightedItem:t},e));o.previousResultCount=n,i(r)}},t=200,n=void 0,function(){for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];n&&clearTimeout(n),n=setTimeout(function(){n=null,e.apply(void 0,i)},t)})};return S.default=S,S.resetIdCounter=function(){r=0},S});
//# sourceMappingURL=downshift.umd.min.js.map
